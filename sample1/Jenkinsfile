pipeline {
     agent any
     triggers {
          pollSCM('* * * * *')
     }
     stages {

       
          stage("print branch name") {
                echo "I am the ${env.BRANCH_NAME} branch"
            }
         
         if (env.BRANCH_NAME == "main") {
                   stage("Code coverage") {
                        steps {
                                sh '''
                                 pwd
                                 chmod + x sample1
                                 cd sample1
                                 pwd
                                 chmod + x gradlew
                                ./gradlew jacocoTestReport
                                '''
                                sh '''
                                 pwd
                                 chmod + x sample1
                                 cd sample1
                                 pwd
                                 chmod + x gradlew
                                ./gradlew jacocoTestCoverageVerification
                                '''
                        }
                    }
         }
         else
         {
                   stage("Unit test") {
                        steps {
                                sh '''
                                 pwd
                                 chmod + x sample1
                                 cd sample1
                                 pwd
                                 chmod + x gradlew
                                ./gradlew test
                                '''
                        }
                    }
                    
                    stage("Static code analysis") {
                        steps {
                                sh '''
                                 pwd
                                 chmod + x sample1
                                 cd sample1
                                 pwd
                                 chmod + x gradlew
                                ./gradlew checkstyleMain
                                '''
                        }
                    }
        }
     
     }
}
